---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: scrapeconfigs
  namespace: monitoring
spec:
  encryptedData:
    lancre_password: AgAGo94USkmdxDPlI3KrmA3tELpJ9PlbpSf+wgUbS0wtVGTDohXC/fOaKNGRxah+Ac+T0xNK0iMgBgyxJ456xWhVc+EJ9kaYjvU5OvBX3GeiiZVWg11mYZAxT4dNnokGil2BQgMHQHCvK/8+g1mqzNLdnxks+4GbVJL9IVMYW9jGcyOvdQB26agzx4WhX01kiUhHpFj541QRdL15Q9aPBeGFRMwxTF6TU4QIkJRyyjFhm8ctGcBVdwZM9MRKCehpEQKG55X4QodnbbUabEiTQddaSMX+dXX5VJICnmEhYk5ALtENw255Y/vIDEK15RgAbMmPQftxjEjOx8IxuyYt3bDRvOi49Es5MFwg0ZL6GAjAZ8prdiNTYi045SBWABmaZoGPzoB7nJhmfEM7Kgyemt4uCNUHDoKdst0yPQF/jNkmh2ep3NDnOQZfdS/dDWYmVXqPcSBwZolWkgdNXeH7/1OcCkuuTeplWYsMAklyP3thrNAUzG4q0l4Jv5ThL9vaYsut4fyiCrJMmKgVu1X1blQKlKzmOg1r17mfqD8NoVYlSuy5gyUwQmUmmnorpAzn+yvKWWR85qGTgbbN+CZBjPGfv8F2n/8UVPu+Z5bdD1tkRAFwqWcvXjhiAVjHrnNS+YX2uYttc5UR+bNqGOMDCqIq17lFwVbn/jf3EU2HFB4wWCkuBpwzF2ZXFMd8bHVZ/IdPZFbWNzrT3eHI6F/hj2Gy2vbTFtshIxKijiI7eWI=
    lancre_username: AgAdnBImk4Pvf187uBBk7a5PV2Z97mH6MJx7h48JQOGeztFFmKvM/0KBkJ84WuLEUFJk2KaBVbeTpBaDrcNtt1cYAFr/FBLQdxLNyQyXh8k7r7h0cwL6xh1yseTZsfstAQvXOsMACtM2NTepzhTexaTYL3giKygY82EgECKXeSdIZ/pqmG/oQGiGMJg5uElJdRYxx/J4cp2ZY6TtkAX9gX2ugmn+jRU+zfjhPmX8npmtXuQhcLIySUBZJ5uTrQOXRXMBhSwJDuvcIOD5/FZPhVo6QUfzBarPrANkoxSGT/NPAW+9kkTDRBDWpKhuXky7VPdb979UG2Uufc/OJdSa322hj6ixA8FD18bPK1hNV59ymCWP2lUlwyD84Agb6twDzUSocGc0t/LCJHdykO1F+9QJbe+kgm0W4W/bdF3f0/XNbQSwgI5SO1nmRUTWpjB8g87C5wNlkBEP3M7wjRHUV7c2L2fRbNb5wvsWmTzUwGi3GJBhthRnR+9f5Ki/kc2YgWh4U9DV2bWOwONtmu58l/BnYGivVmqJwQB5fnUpm3UzsoE/ZNXh48SlPuS6sfgEqYCubUUwVw4O7/n6gcqQ2PAfEw4yuAhGGaxXZAKOCUVzEfahX2zV5M3POgHK2s6tMgHhm8V7FSccQlhQ7QD3q/M/JP5xFTvOCyBLeVsR1zYCIfnHoOp7fCrJovnmhVBXj9nR4cszSnIhUBz
  template:
    metadata:
      annotations:
        sealedsecrets.bitnami.com/managed: "true"
      creationTimestamp: null
      name: scrapeconfigs
      namespace: monitoring
    type: Opaque
    data:
      additional.yaml: |
        - job_name: windows
          static_configs:
          - targets:
            - '192.168.2.50:9182'
            - '192.168.2.51:9182'
          metric_relabel_configs:
          - action: replace
            replacement: pawelpc
            regex: '192.168.2.50:9182'
            source_labels:
            - instance
            target_label: node
          - action: replace
            replacement: aduspc
            regex: '192.168.2.51:9182'
            source_labels:
            - instance
            target_label: node

        - job_name: lancre
          scrape_interval: 30s
          scrape_timeout: 30s
          scheme: 'https'
          honor_labels: true
          metrics_path: '/federate'
          basic_auth:
            username: {{ index . "lancre_username" }}
            password: {{ index . "lancre_password" }}
          params:
            'match[]':
              - '{job=~".+"}'
          static_configs:
            - targets: ['lancre.thaum.xyz']
          metric_relabel_configs:
            - source_labels: [__name__]
              regex: "prometheus_notifications_alertmanagers_discovered"
              action: drop
            - source_labels: ['instance', 'environment']
              regex: "(.*):(.*);(.*)"
              replacement: '$1.$3:$2'
              target_label: 'instance'
            - source_labels: [state]
              regex: '(activating|deactivating)'
              action: drop
            - source_labels: [type]
              regex: '(oneshot|dbus|idle|notify)'
              action: drop
