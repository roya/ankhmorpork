---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: scrapeconfigs
  namespace: monitoring
spec:
  encryptedData:
    lancre_password: AgBiu5296i4TNNBXYXQ9qcB0HXV9sdExyZsSUOxGZM3VptNUgagBHi4lJXOMezAtzKjqGpNB5x/CikXw2yLglBOKElqWrl91bLPr8D2ZUF6cwlGoTmcsWDdH2yhwuElF0koImCP0YjAg4BeWivn00bumgNIjIfvbodRM1cvHR0UDYFOy9N0zbDpRyoXcj+BcoO9WiDjw3Pf+EJjnpnIlwVX+gTOJm6+gQILfq88fMoHa1pOVIEtGBLRi2xPHasnQYrxAA0iTV7Slh2HbkahkRTfdmuJfY3tztxEeZYmQIpXw8pobTc0ZEypZTKywl5Hhh4hs3TxOtiNCrIS0UP0dgwW8GI+6ePJe3dbwXWDCAVMlDZPkJgkWTiQEnWeBrNp/YoE/rMz6pkbkzpLhKgDuuzHMpBRBKYHOqe5YhDoKsolCha0v6PqcawZJfdP9pifPcS0QgIMY6Moj5SHjVaMH7aSTV/t02r6KkfrffSD0TJvVZXq/3g9ibKtk12nnsFaFBN5GkkBm58phImFgfbae2ML82ML9BJ241xTFzl5H3i1Pn5ss8ZgDNtx6KEZZVH9+EWW1rppSnrdTaBBMCTtJ1qZpGTUhsRSpsjTiLtNnsCpa/ryBOCgceDw+4K/pM0eibKu7hPKoIsvIgVgcOrv3Y3vdw9VI03iLSBNRulMYzIKxCxGCLaeYBzdl/f7i+4pH4Y77UiN5AZgG+WuNmuXe6uJT02MbVi+HOua8Y8p8T/E=
    lancre_username: AgB/okvPZXByaZFSgKG+MwNqTfJTgzqLzWVpm4xO/amxCg1EQ0CZUp5ex5R94zjPi7YwaTy9m4l0nYfIFq48mEctEyIWSAIiDr6GJvuAVFi4n+YeI7zL8rmsK3g1txUrHZF69sxXsJ/QQsKGy4NZFffHR0gbeeFtKVFKUBOUTUBYZiekdo4aO9paP9bbbZ2So9JyA3kfKx2Y0jfGsfv05dsBYF4R2+b3MQSp95gH2EJ6VPjOCMcAeb8VTKzoWY62XfxXj60JXYgn9ffDOYo5HfLoI0a8cYdrgPfzPqS2Q9cQPMER0RX1Jz8Y6hi5Mxcx8uK6I+9wrZmxzzCm98sKFXdXxUuubmZp59opnGPQuUBWtAhV7ABGBQIiwFQi6bYFh27+otMbYXkGYf+Ay6AsqnD6v0uK6++v4EO59wLkbyJ9ZtfESHhMS9F/JXZzwjkEblf7kQB7rpnoLmiV49DMruuf1++GAVTa+nlWxDPEE4rRMhZXUHM3sY+J9e33fBVB5+HlJgN+fiZ/MQWFhPGmMVyWi8ipk7zvpyWRarE5TdLgx6nDyZyrdQOoi/in0rmKyfTBer3h72AQyVXFKxouzxcoL7jJNBi0jHYY/y3yhZYqrAyWidglXjjv0toVcXHKxxM4zrHKIIh1rSJrIEY4uEIwmV4cc9OlKd/s5YWNpSGM5vSiuve1i5FfoKcuqhK6FWaPCCI3tvaIRYtt
  template:
    metadata:
      annotations:
        sealedsecrets.bitnami.com/managed: "true"
      creationTimestamp: null
      name: scrapeconfigs
      namespace: monitoring
    type: Opaque
    data:
      additional.yaml: |
        - job_name: windows
          static_configs:
          - targets:
            - '192.168.2.50:9182'
            - '192.168.2.51:9182'
          metric_relabel_configs:
          - action: replace
            replacement: pawelpc
            regex: '192.168.2.50:9182'
            source_labels:
            - instance
            target_label: node
          - action: replace
            replacement: aduspc
            regex: '192.168.2.51:9182'
            source_labels:
            - instance
            target_label: node

        - job_name: lancre
          scrape_interval: 30s
          scrape_timeout: 30s
          scheme: 'https'
          honor_labels: true
          metrics_path: '/federate'
          basic_auth:
            username: {{ index . "lancre_username" }}
            password: {{ index . "lancre_password" }}
          params:
            'match[]':
              - '{job=~".+"}'
          static_configs:
            - targets: ['lancre.thaum.xyz']
          metric_relabel_configs:
            - source_labels: [__name__]
              regex: "prometheus_notifications_alertmanagers_discovered"
              action: drop
            - source_labels: ['instance', 'environment']
              regex: "(.*):(.*);(.*)"
              replacement: '$1.$3:$2'
              target_label: 'instance'
            - source_labels: [state]
              regex: '(activating|deactivating)'
              action: drop
            - source_labels: [type]
              regex: '(oneshot|dbus|idle|notify)'
              action: drop
            - source_labels: [__name__]
              target_label: namespace
              replacement: "lancre"
